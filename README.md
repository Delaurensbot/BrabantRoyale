# Brabant Royale CW Stats Dashboard

Auto-updating CW stats dashboard for Brabant Royale. The site is built with Next.js (App Router + TypeScript) and styled with Tailwind CSS. Data is generated by a Python scraper and stored in `public/data.json`, which the UI reads directly for rendering and copying.

## Quick start

```bash
npm install
npm run dev
```

Visit http://localhost:3000 to view the dashboard.

## Data generation

Use the Python script to scrape cwstats and produce UI-ready data:

```bash
python cwstats_race.py --url "https://cwstats.com/clan/9YP8UY/race"
```

Outputs:
- `public/data.json` (consumed by the UI)
- `public/race.txt` (raw combined text for reference)

## GitHub Actions automation

The workflow `.github/workflows/update-cwstats.yml`:
- Runs every 5 minutes and on manual dispatch.
- Installs Python dependencies from `requirements.txt`.
- Executes `python cwstats_race.py --url "https://cwstats.com/clan/9YP8UY/race"`.
- Commits and pushes only when generated files change.

### How to verify the workflow
- **Trigger a manual run:** In GitHub, go to **Actions → Update CW Stats → Run workflow** and pick the default branch. A successful run shows a green checkmark; click the job to see detailed logs for each step.
- **Confirm files were updated:** After a green run, check the repo history for commits titled `chore: update CW stats data` or browse `public/data.json` / `public/race.txt` in the default branch to confirm fresh timestamps/content.
- **Inspect scheduled runs:** On the Actions page, the runs list should show entries every ~5 minutes. If a run is missing or red, open it to view the failing step and error message.
- **Test locally with the same command:** From your machine or a Codespace, run `python cwstats_race.py --url "https://cwstats.com/clan/9YP8UY/race" --public-dir public` to make sure the scraper still succeeds outside of CI.

## Deploying on Vercel

1. In Vercel, choose **Import Project** and select this GitHub repository.
2. Accept the defaults for a Next.js app (framework detected automatically).
3. Deploy. Every new commit (including the GitHub Action updates) will trigger a fresh deployment.

## Copy interactions
- Each card is clickable; clicking copies that block’s text and shows a “Copied!” toast.
- The “Copy all” button copies all sections exactly as stored in `public/data.json`.

## Countdown logic
The UI calculates the next update using `generated_at_epoch_ms + update_interval_seconds * 1000` from `data.json`, showing `Next update in mm:ss` and the last updated time in your local timezone.
